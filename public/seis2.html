<!DOCTYPE html>
<html>

<head>
    <title>EDS</title>
    <script src="./lib/w2ui/w2ui-2.0.min.js"></script>
    <link rel="stylesheet" type="text/css" href="./lib/w2ui/w2ui-2.0.min.css">
    <link rel="stylesheet" type="text/css" href="./lib/bootstrap-icons.min.css">
</head>
<style>
</style>

<body>
    <div id="main" style="width: 100%; height: 400px;"></div>



    <script>
// widget configuration
let config = {
    layout: {
        name: 'layout',
        padding: 0,
        panels: [
            { type: 'left', size: 200, resizable: true, minSize: 120 },
            { type: 'main', minSize: 550, overflow: 'hidden' }
        ]
    },
    sidebar: {
        name: 'sidebar',
        nodes: [
                { id: 'staging', text: 'Staging Area', icon: 'bi bi-house', expanded: true, selected: true,
                        nodes: [
                            { id: 'level-1-1', text: 'Level 1.1', icon: 'bi bi-folder',
                                nodes: [
                                    { id: 'level-1-1-1', text: 'Level 1.1.1', icon: 'bi bi-folder' },
                                    { id: 'level-1-1-2', text: 'Level 1.1.2', icon: 'bi bi-folder' },
                                    { id: 'level-1-1-3', text: 'Level 1.1.3', icon: 'bi bi-folder' }
                                ]
                            },
                            { id: 'level-1-2', text: 'Level 1.2', icon: 'bi bi-folder', nodes:[]}
                        ]
                }
        ],
        onClick(event) {
            console.log (event.target);
            loadFolderContents(event.target); //List files from selected folder
            
        },
        onDblClick(event) {
            console.log (event.target);
            // loadFolderContents(event.target); //List files from selected folder
            
        }
    },
    grid1: {
        name: 'file_folder_listing',
            box: '#div_file_selection',
            header: '<b>Select Files from Staging Area for Loading</>',
            show: {
                // header: true,
                // footer: true,
                toolbar: true,
                // toolbarAdd: true,
                // lineNumbers: true
            },
            columns: [
                { field: 'file_name', text: 'File Name', size: '30%' },
                { field: 'file_size', text: 'Size', size: '30%' },
                { field: 'modified', text: 'Last Modified', size: '40%' },
                { field: 'created', text: 'Created', size: '90px' }
            ],
            toolbar: {
                items: [
                    { type: 'button', id: 'add_files', text: 'Add files', icon: 'bi bi-plus-circle' },
                    // { type: 'break' },
                    { type: 'button', id: 'done', text: 'Proceed to load data', icon: 'bi bi-arrow-right-square' },
                ],
                onClick: function (target, data) {
                    switch (target) {
                        case "add_files":
                            let selected_files = w2ui.file_folder_listing.getSelection();
                            let num_selected_files = selected_files.length;
                            for (let i = 0; i < num_selected_files; i++) {
                                w2ui.file_load_list.add(
                                {
                                    recid: selected_files[i], 
                                    file_name: w2ui.file_folder_listing.get(selected_files[i]).file_name
                                });
                            }            
                            
                            break;                    
                        default: //Proceed to Load Data
                            change_page_mode("load_seismic");                            
                            break;
                    }
                }
            },
    }
}

let layout = new w2layout(config.layout)
let sidebar = new w2sidebar(config.sidebar)
let grid1 = new w2grid(config.grid1)
// initialization
layout.render('#main')
layout.html('left', sidebar)
layout.html('main', grid1)


function loadFolderContents(){
    grid1.add([{ recid: Math.round(Math.random()*100), file_name: 'file'+Math.round(Math.random()*100)+'.sgy', file_size: Math.round(Math.random()*100) + ' GB', modified: '4/9/2012', created: '4/3/2012'}])
}
    </script>
</body>

</html>